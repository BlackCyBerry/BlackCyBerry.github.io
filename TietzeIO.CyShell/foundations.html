



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Reference documentation for TietzeIO.CyShell, a powershell module to interface with Cylance APIs">
      
      
      
        <meta name="author" content="Jan Tietze">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="/TietzeIO.CyShell/assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Foundations - jan-tee.github.io</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#concepts" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="jan-tee.github.io" class="md-header-nav__button md-logo">
          
            <img src="/TietzeIO.CyShell/assets/cyshell-icon-flattened-128x128.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              jan-tee.github.io
            </span>
            <span class="md-header-nav__topic">
              
                Foundations
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="." title="jan-tee.github.io" class="md-nav__button md-logo">
      
        <img src="/TietzeIO.CyShell/assets/cyshell-icon-flattened-128x128.png" width="48" height="48">
      
    </a>
    jan-tee.github.io
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      TietzeIO.CyShell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        TietzeIO.CyShell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="index.html" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="getting_started.html" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="new_to_powershell.html" title="New to Powershell?" class="md-nav__link">
      New to Powershell?
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Foundations
      </label>
    
    <a href="foundations.html" title="Foundations" class="md-nav__link md-nav__link--active">
      Foundations
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-storage" title="Configuration storage" class="md-nav__link">
    Configuration storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-safe-objects" title="Type safe objects" class="md-nav__link">
    Type safe objects
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="examples.html" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="TietzeIO.CyShell.html" title="Cmdlets" class="md-nav__link">
      Cmdlets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="/TietzeIO.CyAPI/api/" title="TietzeIO.CyAPI" class="md-nav__link">
      TietzeIO.CyAPI
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="/about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-storage" title="Configuration storage" class="md-nav__link">
    Configuration storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-safe-objects" title="Type safe objects" class="md-nav__link">
    Type safe objects
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="concepts">Concepts<a class="headerlink" href="#concepts" title="Permanent link">&para;</a></h1>
<h2 id="configuration-storage">Configuration storage<a class="headerlink" href="#configuration-storage" title="Permanent link">&para;</a></h2>
<p>Configuration storage enables easy automation and convenient access by making connecting to a backend API easy.</p>
<p>Console configuration profiles are persisted in a .JSON file and can be used to refer to a configuration profile by name, eliminating the need to store credentials in your scripts. There are two different providers available that store configuration locally between sessions:</p>
<ul>
<li>The <strong>DPAPI Configuration Storage Adapter</strong>: This is platform-specific for Windows, and automatically enabled for persisting configuration entries when you install in Windows.</li>
<li>The <strong>Plaintext Configuration Storage Adapter</strong>: This is platform-agnostic and supports Windows, MacOS, Linux, and is automatically enabled for persisting configuration entries when you install on non-Windows platforms.</li>
</ul>
<table>
<thead>
<tr>
<th>Adapter</th>
<th>Supported OS</th>
<th>Capabilities</th>
</tr>
</thead>
<tbody>
<tr>
<td>DPAPI</td>
<td>Windows</td>
<td>Encrypted secret storage using Windows DPAPI in a JSON file; secrets can only be accessed by the same user</td>
</tr>
<tr>
<td>Plaintext</td>
<td>Any (Windows, MacOS, Linux)</td>
<td>Plaintext secret storage in a JSON file</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The JSON file is stored in the user's platform-specific profile directory. On Windows, that would be <code>%USERPROFILE%\.cyapi</code>, on Linux, <code>$HOME\.cyapi</code>. For legacy migration reasons from CyCLI to CyShell, if a <code>consoles.json</code> and/or <code>consoles-plaintext.json</code> exists already in <code>%USERPROFILE%</code>, it will be used instead.</p>
</div>
<h2 id="type-safe-objects">Type safe objects<a class="headerlink" href="#type-safe-objects" title="Permanent link">&para;</a></h2>
<p>All object types retrieved from the API are converted to .NET objects. This means that individual cmdlets do not operate on a generic <code>PSObject</code> type object, but expect that inputs are the relevant type.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In CyCLI it was relatively easy to make mistakes - e.g. novice users would expect that for a <code>-Device</code> argument, they could just supply a <em>device name</em> instead of a device object with a Guid in it. This was not possible, and the command would error out with unexpected side effects. In CyShell, arguments are type safe and you can only pass the right type to a cmdlet. This makes piping outputs from one cmdlet into another cmdlet much safer.</p>
</div>
<p>Another effect of using objects is that some of the objects provide additional methods for convenient manipulation of objects; e.g. manipulating policy, because of its structure, is excessively difficult if you were to do it by hand.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="new_to_powershell.html" title="New to Powershell?" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                New to Powershell?
              </span>
            </div>
          </a>
        
        
          <a href="examples.html" title="Examples" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Examples
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>